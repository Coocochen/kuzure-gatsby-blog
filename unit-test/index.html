<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.a787360bb3184f27f56c.css" data-identity="gatsby-global-css">:root{--reach-skip-nav:1}[data-reach-skip-nav-link]{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}[data-reach-skip-nav-link]:focus{clip:auto;background:#fff;height:auto;left:10px;padding:1rem;position:fixed;top:10px;width:auto;z-index:1}.icon{fill:currentColor;color:gray!important;height:1em;margin-right:8px;overflow:hidden;vertical-align:-.15em;width:1em}.github-icon{margin-left:4px}</style><meta name="generator" content="Gatsby 3.8.0"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">jest单元测试、TDD、BDD | Kuzure&#x27;s blog</title><meta data-react-helmet="true" name="description" content="TDD(测试驱动开发) 和 BDD(行为驱动开发) 关于 TDD 和 BDD 网上有各种不同的说法，个人理解的 TDD…"/><meta data-react-helmet="true" property="og:title" content="jest单元测试、TDD、BDD"/><meta data-react-helmet="true" property="og:description" content="TDD(测试驱动开发) 和 BDD(行为驱动开发) 关于 TDD 和 BDD 网上有各种不同的说法，个人理解的 TDD…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:creator" content="kuzure-东山"/><meta data-react-helmet="true" name="twitter:title" content="jest单元测试、TDD、BDD"/><meta data-react-helmet="true" name="twitter:description" content="TDD(测试驱动开发) 和 BDD(行为驱动开发) 关于 TDD 和 BDD 网上有各种不同的说法，个人理解的 TDD…"/><meta data-react-helmet="true" name="og:image" content="https://example.com/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg"/><meta data-react-helmet="true" name="og:image:alt" content="Laptop on a desk with VS Code open."/><meta data-react-helmet="true" name="twitter:image" content="https://example.com/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Laptop on a desk with VS Code open."/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><link rel="icon" href="/favicon-32x32.png?v=06ab9d9be2014a81668d971333f1c826" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=06ab9d9be2014a81668d971333f1c826"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=06ab9d9be2014a81668d971333f1c826"/><link as="script" rel="preload" href="/webpack-runtime-0e9532d95cc9910a1c39.js"/><link as="script" rel="preload" href="/framework-369c4d429c17921ec939.js"/><link as="script" rel="preload" href="/app-169cdacde52f4424d8c0.js"/><link as="script" rel="preload" href="/594a10c5e594bd3faaa0b3336dcd5755131ca933-dc314ffe128654ce0000.js"/><link as="script" rel="preload" href="/799b9e28ec84f08939ab3af68c08e0b6efc8bad3-9a95b2b3e1246e8b8008.js"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-584fd14bbf5e66449225.js"/><link as="fetch" rel="preload" href="/page-data/unit-test/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3090755652.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/764694655.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global za2myr">body{--theme-ui-colors-text:#282c35;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#B85883;--theme-ui-colors-secondary:#1B1F23;--theme-ui-colors-muted:hsla(0, 0%, 0%, 0.2);--theme-ui-colors-highlight:rgba(255, 229, 100, 0.2);--theme-ui-colors-heading:#282c35;--theme-ui-colors-prism-background:#011627;--theme-ui-colors-prism-comment:#809393;--theme-ui-colors-prism-string:#addb67;--theme-ui-colors-prism-var:#d6deeb;--theme-ui-colors-prism-number:#f78c6c;--theme-ui-colors-prism-constant:#82aaff;--theme-ui-colors-prism-punctuation:#c792ea;--theme-ui-colors-prism-className:#ffc98b;--theme-ui-colors-prism-tag:#ffa7c4;--theme-ui-colors-prism-boolean:#ff5874;--theme-ui-colors-prism-property:#80cbc4;--theme-ui-colors-prism-namespace:#b2ccd6;--theme-ui-colors-prism-highlight:hsla(207, 95%, 15%, 1);color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}body.theme-ui-dark{--theme-ui-colors-text:rgba(255, 255, 255, 0.86);--theme-ui-colors-background:#232129;--theme-ui-colors-primary:#D9BAE8;--theme-ui-colors-secondary:rgba(255, 255, 255, 0.86);--theme-ui-colors-muted:hsla(0, 0%, 100%, 0.2);--theme-ui-colors-highlight:#663399;--theme-ui-colors-heading:#fff;}</style><style data-emotion="css-global 8ir1vi">*{box-sizing:border-box;}body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css ocpejr">.css-ocpejr{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;}</style><div class="css-ocpejr"><div><style data-emotion="css 1mbzohk">.css-1mbzohk{height:50px;background:#B85883;position:fixed;width:100%;z-index:99;}</style><nav class="css-1mbzohk"><style data-emotion="css vpjj7i">.css-vpjj7i{margin-right:8px;margin-bottom:0;width:48px;min-width:48px;margin-left:20px;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-vpjj7i"><div style="max-width:739px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;738&#x27; width=&#x27;739&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#b85888;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/06ab9d9be2014a81668d971333f1c826/c5b6a/favicon.webp 185w,/static/06ab9d9be2014a81668d971333f1c826/3cb69/favicon.webp 370w,/static/06ab9d9be2014a81668d971333f1c826/408c0/favicon.webp 739w" sizes="(min-width: 739px) 739px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 739px) 739px, 100vw" decoding="async" loading="lazy" data-src="/static/06ab9d9be2014a81668d971333f1c826/f0ef8/favicon.png" data-srcset="/static/06ab9d9be2014a81668d971333f1c826/abab1/favicon.png 185w,/static/06ab9d9be2014a81668d971333f1c826/60f50/favicon.png 370w,/static/06ab9d9be2014a81668d971333f1c826/f0ef8/favicon.png 739w" alt="kuzure"/></picture><noscript><picture><source type="image/webp" srcSet="/static/06ab9d9be2014a81668d971333f1c826/c5b6a/favicon.webp 185w,/static/06ab9d9be2014a81668d971333f1c826/3cb69/favicon.webp 370w,/static/06ab9d9be2014a81668d971333f1c826/408c0/favicon.webp 739w" sizes="(min-width: 739px) 739px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 739px) 739px, 100vw" decoding="async" loading="lazy" src="/static/06ab9d9be2014a81668d971333f1c826/f0ef8/favicon.png" srcSet="/static/06ab9d9be2014a81668d971333f1c826/abab1/favicon.png 185w,/static/06ab9d9be2014a81668d971333f1c826/60f50/favicon.png 370w,/static/06ab9d9be2014a81668d971333f1c826/f0ef8/favicon.png 739w" alt="kuzure"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></nav><header><style data-emotion="css 1a161fb">.css-1a161fb{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;}</style><div class="css-1a161fb"><style data-emotion="css fplwad">.css-fplwad{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:32px;}</style><div class="css-fplwad"><style data-emotion="css 476fwd">.css-476fwd{margin-top:50px;margin-bottom:0;}</style><style data-emotion="css 8k46dd">.css-8k46dd{margin-top:50px;margin-bottom:0;}</style><p class="css-8k46dd"><style data-emotion="css 2ifw1d">.css-2ifw1d{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary);}</style><style data-emotion="css 1awiyq">.css-1awiyq{color:var(--theme-ui-colors-primary);box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary);}</style><a class="css-1awiyq" href="/">Kuzure&#x27;s blog</a></p></div></div></header></div><div id="reach-skip-nav" data-reach-skip-nav-content=""></div><div><style data-emotion="css 1in33uw">.css-1in33uw{max-width:672px;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:32px;padding-bottom:32px;}</style><div class="css-1in33uw"><main><article><header><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:1380px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;920&#x27; width=&#x27;1380&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#282848;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/b0cd1/photo-1517694712202-14dd9538aa97.webp 345w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/8921c/photo-1517694712202-14dd9538aa97.webp 690w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/1e5d7/photo-1517694712202-14dd9538aa97.webp 1380w" sizes="(min-width: 1380px) 1380px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1380px) 1380px, 100vw" decoding="async" loading="lazy" data-src="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg" data-srcset="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/24c12/photo-1517694712202-14dd9538aa97.jpg 345w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/fcb19/photo-1517694712202-14dd9538aa97.jpg 690w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg 1380w" alt="Laptop on a desk with VS Code open."/></picture><noscript><picture><source type="image/webp" srcSet="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/b0cd1/photo-1517694712202-14dd9538aa97.webp 345w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/8921c/photo-1517694712202-14dd9538aa97.webp 690w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/1e5d7/photo-1517694712202-14dd9538aa97.webp 1380w" sizes="(min-width: 1380px) 1380px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1380px) 1380px, 100vw" decoding="async" loading="lazy" src="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg" srcSet="/static/9b328c8d70dc0d3a7a5a4b186fc707d8/24c12/photo-1517694712202-14dd9538aa97.jpg 345w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/fcb19/photo-1517694712202-14dd9538aa97.jpg 690w,/static/9b328c8d70dc0d3a7a5a4b186fc707d8/e355e/photo-1517694712202-14dd9538aa97.jpg 1380w" alt="Laptop on a desk with VS Code open."/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><h1 class="css-0">jest单元测试、TDD、BDD</h1><style data-emotion="css rsra4b">.css-rsra4b{font-size:14px;margin-top:-16px;margin-bottom:16px;}</style><style data-emotion="css 1jnjfic">.css-1jnjfic{font-size:14px;margin-top:-16px;margin-bottom:16px;}.css-1jnjfic code{font-size:inherit;}</style><p class="css-1jnjfic">June 24, 2021</p></header><section><style data-emotion="css 17gfwuz">.css-17gfwuz{pointer-events:painted;}.css-17gfwuz a{visibility:hidden;}.css-17gfwuz:hover a{visibility:visible;}</style><h3 id="tdd测试驱动开发-和-bdd行为驱动开发" class="css-17gfwuz"><style data-emotion="css yixlj4">.css-yixlj4{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary);}</style><a href="#tdd测试驱动开发-和-bdd行为驱动开发" aria-label="TDD(测试驱动开发) 和 BDD(行为驱动开发)" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TDD(测试驱动开发) 和 BDD(行为驱动开发)</h3><style data-emotion="css 1ek8oqb">.css-1ek8oqb code{font-size:inherit;}</style><p class="css-1ek8oqb">关于 TDD 和 BDD 网上有各种不同的说法，个人理解的 TDD，就是首先明确自己想要写什么代码，尽量从最简单的开始，写一个测试，再去具体地实现这小段代码，以达到这个测试通过的效果，之后再继续写测试、实现、测试通过，这样不停循环重构。</p><p class="css-1ek8oqb">例如写一个函数，我们可以首先写函数的调用的测试，然后实现代码并测试成功后，再测试函数的返回值，再继续实现函数…</p><p class="css-1ek8oqb">TDD 的好处就是会减少程序逻辑的错误，尽可能地减少 bug。而缺点就是如果更改了代码的实现逻辑，就需要修改测试，可能会使得测试代码难以维护。</p><p class="css-1ek8oqb">BDD 是 TDD 的一种补充，在 TDD 的基础上，采用了更详细的功能描述，通过考虑用户的行为、组件的功能，来编写测试。</p><p class="css-1ek8oqb">考虑到项目的复杂度和依赖性，TDD 需要简单和易于测试的代码，否则需要开发人员花较多的时间进行一些桥接的工作。因此个人比较推荐 BDD 的测试模式，通过功能和行为的描述，即行为/条件…结果…，进行测试。</p><p class="css-1ek8oqb">但是具体的模式可以根据实际开发工作进行选择。</p><p class="css-1ek8oqb">TDD 和 BDD 的比较可以参考: <style data-emotion="css 1xfcqgg">.css-1xfcqgg{color:var(--theme-ui-colors-primary);}</style><a href="https://segmentfault.com/a/1190000018512127?utm_source=tag-newest" class="css-1xfcqgg">关于 TDD 和 BDD</a></p><h3 id="编写-react-组件的单元测试" class="css-17gfwuz"><a href="#编写-react-组件的单元测试" aria-label="编写 react 组件的单元测试" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>编写 react 组件的单元测试</h3><p class="css-1ek8oqb">单元测试工具采用 <style data-emotion="css 118aluo">.css-118aluo{border-radius:0.3em;color:var(--theme-ui-colors-secondary);background-color:var(--theme-ui-colors-highlight);padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-118aluo">jest</code>, 官方介绍，jest 是一款开箱即用的测试框架，相比其它的测试工具，更简洁明快。</p><p class="css-1ek8oqb">组件测试的步骤大致如下：</p><h4 id="1）测试组件的分支渲染" class="css-17gfwuz"><a href="#1）测试组件的分支渲染" aria-label="1）测试组件的分支渲染" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1）测试组件的分支渲染</h4><style data-emotion="css rczgmi">.css-rczgmi{font-family:Menlo,monospace;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;margin-bottom:8px;color:white;background-color:var(--theme-ui-colors-prism-background);overflow:auto;border-radius:10px;padding:16px;}.css-rczgmi .attr-name{font-style:italic;}.css-rczgmi .comment{color:var(--theme-ui-colors-prism-comment);}.css-rczgmi .attr-name,.css-rczgmi .string,.css-rczgmi .url{color:var(--theme-ui-colors-prism-string);}.css-rczgmi .variable{color:var(--theme-ui-colors-prism-var);}.css-rczgmi .number{color:var(--theme-ui-colors-prism-number);}.css-rczgmi .builtin,.css-rczgmi .char,.css-rczgmi .constant,.css-rczgmi .function{color:var(--theme-ui-colors-prism-constant);}.css-rczgmi .punctuation,.css-rczgmi .selector,.css-rczgmi .doctype{color:var(--theme-ui-colors-prism-punctuation);}.css-rczgmi .class-name{color:var(--theme-ui-colors-prism-className);}.css-rczgmi .tag,.css-rczgmi .operator,.css-rczgmi .keyword{color:var(--theme-ui-colors-prism-tag);}.css-rczgmi .boolean{color:var(--theme-ui-colors-prism-boolean);}.css-rczgmi .property{color:var(--theme-ui-colors-prism-property);}.css-rczgmi .namespace{color:var(--theme-ui-colors-prism-namespace);}.css-rczgmi .highlight{background:hsla(0, 0%, 40%, .5);}</style><style data-emotion="css 1q7q4hh">.css-1q7q4hh{font-family:Menlo,monospace;font-size:inherit;}</style><style data-emotion="css 1wbk7c2">.css-1wbk7c2{font-family:Menlo,monospace;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;margin-bottom:8px;color:white;background-color:var(--theme-ui-colors-prism-background);overflow:auto;border-radius:10px;padding:16px;font-family:Menlo,monospace;font-size:inherit;}.css-1wbk7c2 .attr-name{font-style:italic;}.css-1wbk7c2 .comment{color:var(--theme-ui-colors-prism-comment);}.css-1wbk7c2 .attr-name,.css-1wbk7c2 .string,.css-1wbk7c2 .url{color:var(--theme-ui-colors-prism-string);}.css-1wbk7c2 .variable{color:var(--theme-ui-colors-prism-var);}.css-1wbk7c2 .number{color:var(--theme-ui-colors-prism-number);}.css-1wbk7c2 .builtin,.css-1wbk7c2 .char,.css-1wbk7c2 .constant,.css-1wbk7c2 .function{color:var(--theme-ui-colors-prism-constant);}.css-1wbk7c2 .punctuation,.css-1wbk7c2 .selector,.css-1wbk7c2 .doctype{color:var(--theme-ui-colors-prism-punctuation);}.css-1wbk7c2 .class-name{color:var(--theme-ui-colors-prism-className);}.css-1wbk7c2 .tag,.css-1wbk7c2 .operator,.css-1wbk7c2 .keyword{color:var(--theme-ui-colors-prism-tag);}.css-1wbk7c2 .boolean{color:var(--theme-ui-colors-prism-boolean);}.css-1wbk7c2 .property{color:var(--theme-ui-colors-prism-property);}.css-1wbk7c2 .namespace{color:var(--theme-ui-colors-prism-namespace);}.css-1wbk7c2 .highlight{background:hsla(0, 0%, 40%, .5);}</style><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;测试 CustomPicker组件&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;默认状态下只渲染样板不渲染取色板&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">CustomPicker</span><span class="token plain"> color</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;3b71fb&quot;</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><style data-emotion="css 13aqjzy">.css-13aqjzy{display:inline-block;}</style><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">exists</span><span class="token punctuation">(</span><span class="token string">&quot;.swatch-wrapper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">exists</span><span class="token punctuation">(</span><span class="token string">&quot;popover-wrapper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;点击样板后取色板成功渲染&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">CustomPicker</span><span class="token plain"> color</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;3b71fb&quot;</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">    wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token string">&quot;.swatch-wrapper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">simulate</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">exists</span><span class="token punctuation">(</span><span class="token string">&quot;popover-wrapper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">describe 会形成一个作用域，对于其包含的测试需全部执行成功，才算测试成功。</p><p class="css-1ek8oqb">每一个 it 形成一个单独的测试作用域，第一个参数为这个测试的断言，第二个回调函数中编写具体的测试。</p><p class="css-1ek8oqb">测试 react 组件需要用到 enzyme 的 mount(全渲染)/shallow(浅渲染)/render(静态渲染)方法，来渲染组件，获取组件的 dom 结构。</p><p class="css-1ek8oqb">获取到组件的 dom 结构之后，就可以对组件的渲染进行测试。</p><p class="css-1ek8oqb">使用 simulate 可以模拟交互事件的触发。</p><p class="css-1ek8oqb">在交互事件或者组件生命周期调用之后，可以使用 expect 语句测试是否结果达到预期。</p><p class="css-1ek8oqb">expect 代表期望，用于描述测试的期望结果。比如一个简单的 1+1 等于 2 的测试，可以写为 expect(1+1).toBe(2)，这代表了一个成功的测试。</p><p class="css-1ek8oqb">对于上面图片中的测试，都是在测不同情况下，组件的渲染。</p><p class="css-1ek8oqb">对于组件的渲染，常用到的测试的方法有：</p><p class="css-1ek8oqb">.exists(selector)判断是否存在<br/>
<!-- -->.find(selector) 获取 dom 节点<br/>
<!-- -->.at(number) 获取指定索引的 dom 节点<br/>
<!-- -->.filter(selector) 根据选择器过滤 dom 节点<br/>
<!-- -->.filterWhere(fn) 根据函数返回值过滤 dom 节点<br/>
<!-- -->.text() 获取 dom 节点的文字内容<br/>
<!-- -->.props() 获取 dom 节点的属性。<br/>
<!-- -->.hasClass(className) 判断是否包含这个类，返回 true 或者 false<br/>
<!-- -->.contains(node) 确定是否包含该节点或者一些节点 ，返回 true 或者 false<br/>
<!-- -->常用的 jest 匹配器：</p><p class="css-1ek8oqb">.toBe() 浅比较是否相等<br/>
<!-- -->.toEqual() 可以对需要深比较的对象进行匹配<br/>
<!-- -->.not 测试相反的用例<br/>
<!-- -->.toBeGreaterThan() 大于<br/>
<!-- -->.toBeLessThan() 小于<br/>
<!-- -->.toMatch() 匹配正则表达式<br/>
<!-- -->.toHaveLength(number) 匹配数组、字符串长度</p><p class="css-1ek8oqb">打印节点的 dom 结构可以使用</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token plain">selector</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">更多的 enzyme 的 api 可以参考<a href="https://enzymejs.github.io/enzyme/docs/api/" class="css-1xfcqgg">https://enzymejs.github.io/enzyme/docs/api/</a></p><h4 id="2）测试父组件传递的方法是否被正确调用" class="css-17gfwuz"><a href="#2）测试父组件传递的方法是否被正确调用" aria-label="2）测试父组件传递的方法是否被正确调用" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2）测试父组件传递的方法是否被正确调用</h4><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;当改变输入框输入时，父组件传递的changeName方法被正确的参数值调用&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> changeName </span><span class="token operator">=</span><span class="token plain"> jest</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Search</span><span class="token plain"> changeName</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">changeName</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token string">&quot;input.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">simulate</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    target</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      value</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&quot;kuzure&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">changeName</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">&quot;kuzure&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">对于父组件传递的函数方法，需要测试是否被正确的参数调用。</p><p class="css-1ek8oqb">测试函数调用之前，需要将测试的函数进行 Mock，才可以被测试是否被调用。</p><p class="css-1ek8oqb">mock 函数可以捕捉函数的调用情况，设置函数的内部实现和返回值。</p><p class="css-1ek8oqb">Mock 函数的方法主要有</p><p class="css-1ek8oqb">jest.fn() 简单的返回一个 mock 函数，被调用后并不会执行
jest.spyOn() 不仅可以捕获函数的调用情况，被调用后还会执行
jest.mock() 可以 mock 整个模块
测试函数调用的方法有</p><p class="css-1ek8oqb">toHaveBeenCalledWith(params) 被指定的参数调用
toHaveBeenCalled() 被调用
not.toHaveBeenCalled() 没有被调用
toHaveBeenCalledTimes(number) 被调用的次数</p><h3 id="运行单元测试，查看覆盖率" class="css-17gfwuz"><a href="#运行单元测试，查看覆盖率" aria-label="运行单元测试，查看覆盖率" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>运行单元测试，查看覆盖率</h3><p class="css-1ek8oqb">在终端输入 npm run jest —coverage，回车即可运行单元测试并查看覆盖率</p><p class="css-1ek8oqb">打开.tmp/coverage/lcov-report/index.html 可以查看具体的测试报告<br/>
<!-- -->Statements 代表声明覆盖率，Branches 代表分支覆盖率，Functions 代表函数覆盖率，Lines 代表代码行覆盖率。</p><h3 id="一些踩坑经验" class="css-17gfwuz"><a href="#一些踩坑经验" aria-label="一些踩坑经验" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一些踩坑经验</h3><h4 id="当组件生命周期或交互事件触发了异步请求" class="css-17gfwuz"><a href="#当组件生命周期或交互事件触发了异步请求" aria-label="当组件生命周期或交互事件触发了异步请求" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>当组件生命周期或交互事件触发了异步请求</h4><p class="css-1ek8oqb">jest 不会真正执行异步请求，而是直接跳过异步语句。请将下面的代码粘贴到项目中</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> act </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react-dom/test-utils&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token parameter">amount </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter number">0</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token plain">resolve</span><span class="token punctuation">,</span><span class="token plain"> amount</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">actWait</span><span class="token punctuation">(</span><span class="token parameter">amount </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter number">0</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">await</span><span class="token plain"> </span><span class="token function">act</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">await</span><span class="token plain"> </span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token plain">amount</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">updateWrapper</span><span class="token punctuation">(</span><span class="token parameter">wrapper</span><span class="token parameter punctuation">,</span><span class="token parameter"> amount </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter number">0</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">await</span><span class="token plain"> </span><span class="token function">act</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">await</span><span class="token plain"> </span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token plain">amount</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre><p class="css-1ek8oqb">当测试过程触发了异步操作，则需要在触发之后加上</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token keyword control-flow">await</span><span class="token plain"> </span><span class="token function">updateWrapper</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-1ek8oqb">如果出现 thrown: undefined 的报错，则可能是测试过程有触发了的异步请求没有mock，或者没有mock返回值。</p><p class="css-1ek8oqb">一个简单的异步请求的mock可以写作：</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token plain">api</span><span class="token punctuation">.</span><span class="token property-access">getData</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> jest</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> success</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><h4 id="如何获取到组件的实例" class="css-17gfwuz"><a href="#如何获取到组件的实例" aria-label="如何获取到组件的实例" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何获取到组件的实例</h4><p class="css-1ek8oqb">有时候，我们想测试组件中的方法的调用情况是否正确、mock其返回，这时我们就需要获取到组件的实例。</p><p class="css-1ek8oqb">需要注意的是，如果组件采用了hook的方式编写，那么是无法获取到组件的实例的，也就拿不到组件中的方法。</p><p class="css-1ek8oqb">所以，如果我们想要获取组件的实例，必须保证被测组件是class组件。</p><p class="css-1ek8oqb">普通的class组件，获取实例的方法为</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-1ek8oqb">连接了redux的组件实例获取</p><p class="css-1ek8oqb">redux官方建议，测试连接redux的组件时，单独将组件导出一次，从而避免测试被connect包裹的高阶组件。</p><p class="css-1ek8oqb">被antd的Form包裹的高阶组件</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token keyword">let</span><span class="token plain"> form</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">mountWithIntl</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Component</span><span class="token plain"> wrappedComponentRef</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">form</span><span class="token operator">=</span><span class="token plain"> node</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-1ek8oqb">form就是组件的实例</p><h4 id="当我们通过实例手动更新了组件的state" class="css-17gfwuz"><a href="#当我们通过实例手动更新了组件的state" aria-label="当我们通过实例手动更新了组件的state" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>当我们通过实例手动更新了组件的state</h4><p class="css-1ek8oqb">如果通过setState()更新了state, 则需要在后面加上</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token plain">wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-1ek8oqb">这样state才会更新到组件的dom结构中。</p><h4 id="组件中使用了localstorage存储数据" class="css-17gfwuz"><a href="#组件中使用了localstorage存储数据" aria-label="组件中使用了localstorage存储数据" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件中使用了localstorage存储数据</h4><p class="css-1ek8oqb">被测组件中如果使用了store.set、store.get方法，需要使用mock，否则jest会报错</p><p class="css-1ek8oqb">我们可以在beforeEach钩子函数中mock上述方法</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> storage </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> username</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;kuzure&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  store</span><span class="token punctuation">.</span><span class="token property-access">get</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> jest</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockImplementation</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">return</span><span class="token plain"> storage</span><span class="token punctuation">[</span><span class="token plain">key</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  store</span><span class="token punctuation">.</span><span class="token property-access">set</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> jest</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token parameter punctuation">,</span><span class="token parameter"> value</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token maybe-class-name">Storage</span><span class="token punctuation">[</span><span class="token plain">key</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">value</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">beforeEach会在每一条测试执行之前执行，当beforeEach写在describe内时，只适用于describe块内的测试。</p><p class="css-1ek8oqb">通过mockImplementation()来mock store的具体实现</p><h4 id="子组件连接了redux" class="css-17gfwuz"><a href="#子组件连接了redux" aria-label="子组件连接了redux" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>子组件连接了redux</h4><p class="css-1ek8oqb">如果子组件连接了redux，则在渲染组件时jest会报错，这时我们需要将子组件整个mock掉</p><p class="css-1ek8oqb">在测试文件上方这么写（必须在describe之外)：</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token plain">jest</span><span class="token punctuation">.</span><span class="token method function property-access">mock</span><span class="token punctuation">(</span><span class="token string">&#x27;../../ChildComponent&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 引号中为子组件的相对路径</span></div></pre><h4 id="测试saga" class="css-17gfwuz"><a href="#测试saga" aria-label="测试saga" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试saga</h4><p class="css-1ek8oqb">对于saga函数，我们主要测试是否调用了正确的api、是否发送了正确的action。</p><p class="css-1ek8oqb">使用redux-saga-test-plan第三方插件，我们可以在测试文件中这么写:</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> testSaga </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga-test-plan&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> fetchData </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;../entity&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;当接口正常返回数据，发送正确的action&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  api</span><span class="token punctuation">.</span><span class="token property-access">get</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> jest</span><span class="token punctuation">.</span><span class="token method function property-access">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">mockResolvedValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> data</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token function">testSaga</span><span class="token punctuation">(</span><span class="token plain">fetchData</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span><span class="token plain">api</span><span class="token punctuation">.</span><span class="token property-access">get</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;api/v1/data&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> data</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">FETCH_DATA</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      value</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">.</span><span class="token method function property-access">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre><p class="css-1ek8oqb">.next(params)表示执行到下一步的yield语句，参数表示上一步yield语句的返回值</p><p class="css-1ek8oqb">.call(fn)表示断言函数被调用</p><p class="css-1ek8oqb">.put(action)表示断言发送了指定的action</p><p class="css-1ek8oqb">.isDone() 表示断言saga函数已经结束</p><p class="css-1ek8oqb">更多参考：<a href="https://github.com/jfairbank/redux-saga-test-plan#unit-testing" class="css-1xfcqgg">https://github.com/jfairbank/redux-saga-test-plan#unit-testing</a></p><h4 id="测试reducer" class="css-17gfwuz"><a href="#测试reducer" aria-label="测试reducer" class="css-yixlj4"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试reducer</h4><p class="css-1ek8oqb">这个部分主要测试是否正确完成计算，输入输出十分明确，非常适合做单元测试</p><pre class="language-js prism-code language-javascript css-1wbk7c2"><div class="token-line"><span class="token function">it</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;panel is pushed to panels state&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">fromJS</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    panels</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;jest&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> expected </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    panels</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;jest&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> result </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">dashboard</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function">addPanel</span><span class="token punctuation">(</span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain css-13aqjzy">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">result</span><span class="token punctuation">.</span><span class="token method function property-access">toJS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toEqual</span><span class="token punctuation">(</span><span class="token plain">expected</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre></section></article></main><style data-emotion="css 1i8tjli">.css-1i8tjli{margin-top:32px;padding-top:16px;}</style><footer class="css-1i8tjli"><style data-emotion="css 1mbou4u">.css-1mbou4u{border-color:var(--theme-ui-colors-muted);}</style><hr class="css-1mbou4u"/><style data-emotion="css ve7ya4">.css-ve7ya4{margin-bottom:32px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><style data-emotion="css tcsn83">.css-tcsn83{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:32px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="css-tcsn83"><a href="/intro"><style data-emotion="css 3fu24g">.css-3fu24g{margin-right:8px;margin-bottom:16px;width:48px;min-width:48px;border-radius:99999px;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-3fu24g"><div style="max-width:737px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;737&#x27; width=&#x27;737&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#a88898;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/b3f5b7cbe2375a4f84e90a3beb369f79/42e3f/avatar.webp 184w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/f8026/avatar.webp 369w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/42901/avatar.webp 737w" sizes="(min-width: 737px) 737px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 737px) 737px, 100vw" decoding="async" loading="lazy" data-src="/static/b3f5b7cbe2375a4f84e90a3beb369f79/e5580/avatar.jpg" data-srcset="/static/b3f5b7cbe2375a4f84e90a3beb369f79/fca36/avatar.jpg 184w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/b36ca/avatar.jpg 369w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/e5580/avatar.jpg 737w" alt="kuzure"/></picture><noscript><picture><source type="image/webp" srcSet="/static/b3f5b7cbe2375a4f84e90a3beb369f79/42e3f/avatar.webp 184w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/f8026/avatar.webp 369w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/42901/avatar.webp 737w" sizes="(min-width: 737px) 737px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 737px) 737px, 100vw" decoding="async" loading="lazy" src="/static/b3f5b7cbe2375a4f84e90a3beb369f79/e5580/avatar.jpg" srcSet="/static/b3f5b7cbe2375a4f84e90a3beb369f79/fca36/avatar.jpg 184w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/b36ca/avatar.jpg 369w,/static/b3f5b7cbe2375a4f84e90a3beb369f79/e5580/avatar.jpg 737w" alt="kuzure"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a><div class="css-0"><div><div><span>kuzure-东山</span><a href="https://github.com/kuzurec" class="css-1xfcqgg"><svg class="icon github-icon" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a></div><style data-emotion="css 12fs3jb">.css-12fs3jb{color:gray;font-size:13px;margin-top:4px;}</style><div class="css-12fs3jb">东边有座山</div></div></div></div><style data-emotion="css 11r1i3o">.css-11r1i3o{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;list-style:none;padding:0;}</style><style data-emotion="css f95zwa">.css-f95zwa{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;list-style:none;padding:0;}</style><ul class="css-f95zwa e1f4mtpc0"><li><a rel="prev" class="css-1xfcqgg" href="/about/">← <!-- -->关于这里</a></li><li><a rel="next" class="css-1xfcqgg" href="/are-you-lonesome-tonight/">热带往事 --发生在潮湿初夏的一段关于救赎的往事<!-- --> →</a></li></ul></footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>var head = document.head || document.getElementsByTagName("head")[0];var script = document.createElement("script");script.setAttribute("src", "https://cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js");script.setAttribute("type", "text/javascript");script.setAttribute("charset", "utf8");script.setAttribute("async", "");head.appendChild(script);</script><script>var head = document.head || document.getElementsByTagName("head")[0];var script = document.createElement("script");script.setAttribute("src", "https://blog-static.cnblogs.com/files/melodyjerry/cursor-effects.js");script.setAttribute("type", "text/javascript");script.setAttribute("charset", "utf8");script.setAttribute("async", "");head.appendChild(script);</script><script>var head = document.head || document.getElementsByTagName("head")[0];var script = document.createElement("script");script.setAttribute("src", "http://static.kuzure.club/iconfont.js");script.setAttribute("type", "text/javascript");script.setAttribute("charset", "utf8");script.setAttribute("async", "");head.appendChild(script);</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/unit-test/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-318f69286c26ef0a1952.js"],"app":["/app-169cdacde52f4424d8c0.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-650edf50d8f6d8e3896c.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-584fd14bbf5e66449225.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-35a5f686be474d640462.js"],"component---src-pages-intro-js":["/component---src-pages-intro-js-47b8f3356b1fcab22686.js"]};/*]]>*/</script><script src="/polyfill-318f69286c26ef0a1952.js" nomodule=""></script><script src="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-584fd14bbf5e66449225.js" async=""></script><script src="/799b9e28ec84f08939ab3af68c08e0b6efc8bad3-9a95b2b3e1246e8b8008.js" async=""></script><script src="/594a10c5e594bd3faaa0b3336dcd5755131ca933-dc314ffe128654ce0000.js" async=""></script><script src="/app-169cdacde52f4424d8c0.js" async=""></script><script src="/framework-369c4d429c17921ec939.js" async=""></script><script src="/webpack-runtime-0e9532d95cc9910a1c39.js" async=""></script></body></html>